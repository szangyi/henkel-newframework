var pages=pages||[],stop=!1,stopId=null,stopPages=[],docEl=document.documentElement,view=document.querySelector(".view"),logo=document.querySelector(".logo"),prev=document.querySelector(".prev"),next=document.querySelector(".next"),menu=document.querySelector(".menu"),thumbs=document.querySelector("#thumbs"),bar=document.querySelector(".bar"),count=document.querySelector(".count"),pageIndex=0,pageRange=[],startTimeStamp=null,processedUnload=!1,reachedEnd=!1;function pageEnter(){startTimeStamp=new Date,SCORM.init();"unknown"==SCORM.getValue("cmi.completion_status",!0)&&SCORM.setValue("cmi.completion_status","incomplete");let e=SCORM.getValue("cmi.location",!1);pageGo(pageIndex=e&&confirm("Would you like to resume from where you previously left off?")?parseInt(e,10):0)}function pageExit(){0==reachedEnd&&confirm("Would you like to save your progress to resume later?")?(SCORM.setValue("cmi.exit","suspend"),SCORM.setValue("adl.nav.request","suspendAll")):(SCORM.setValue("cmi.exit",""),SCORM.setValue("adl.nav.request","exitAll")),pageTerminate(!0)}function pageTerminate(e){if(1==processedUnload)return;processedUnload=!0;const t=(new Date).getTime()-startTimeStamp.getTime(),n=SCORM.time(t);SCORM.setValue("cmi.session_time",n),0==e&&0==reachedEnd&&SCORM.setValue("cmi.exit","suspend"),SCORM.terminate()}function pageGo(e){const t=pages.length-1;pageIndex=Math.min(Math.max(e,0),t),stopAndGoCheck(),prev.disabled=0===pageIndex,next.disabled=pageIndex===t||stop,bar.style.transform=`scaleX(${pageIndex/t})`,count.innerText=pageIndex+1+"/"+(t+1);const n=thumbs.querySelector(".active");n&&n.classList.remove("active");const a=thumbs.querySelector(`[data-index="${pageIndex}"]`);a.classList.add("active"),a.scrollIntoView({behavior:"smooth",block:"nearest"}),SCORM.setValue("cmi.location",pageIndex),pageIndex===t&&(reachedEnd=!0,SCORM.setValue("cmi.completion_status","completed")),view.style.opacity=0,docEl.classList.add("loading"),setTimeout((()=>{view.src=`${pages[pageIndex]}/index.html`}),200)}function pagePrev(){pageIndex&&pageGo(--pageIndex)}function pageNext(){pageIndex<pages.length-1&&pageGo(++pageIndex)}function asideToggle(){var e=document.documentElement.classList.contains("player-aside-open")?"remove":"add";document.documentElement.classList[e]("player-aside-open")}function asideClose(){document.documentElement.classList.remove("player-aside-open")}function viewLoad(){view.style.opacity="",docEl.style.pointerEvents="",docEl.style.opacity="",docEl.classList.remove("loading"),asideClose(),stopAndGoCheck()}function pageMessageRecieve(e){try{let t=JSON.parse(e.data),n=t.action,a=t.args;switch(n){case"pageRange":pageRange=a;break;case"pageGo":pageGo(a);break;case"pagePrev":pagePrev();break;case"pageNext":pageNext()}}catch(e){return}}addEventListener("load",pageEnter),addEventListener("unload",pageTerminate),addEventListener("beforeunload",pageTerminate),addEventListener("message",pageMessageRecieve,!1),logo.addEventListener("click",(()=>pageGo(0))),prev.addEventListener("click",pagePrev),next.addEventListener("click",pageNext),menu.addEventListener("click",asideToggle),view.addEventListener("load",viewLoad),docEl.style.pointerEvents="none",docEl.style.opacity=0;const nextClickCover=document.createElement("div"),nextRect=next.getBoundingClientRect();function stopAndGoCheck(){const e=pages.length-1;if(stopId&&stopPages.length){var t=Math.max(pageIndex,Math.min(...stopPages)-1,parseInt(localStorage.getItem(stopId)||0,10));localStorage.setItem(stopId,t),stopPages=stopPages.filter((e=>e>t)),stop=pageIndex>=t&&stopPages.length,next.disabled=pageIndex===e||stop,next.style.cssText=stop?"\n\t\t                background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23fff' viewBox='0 0 24 24'%3E%3Cpath d='M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zM9 6c0-1.66 1.34-3 3-3s3 1.34 3 3v2H9V6zm9 14H6V10h12v10zm-6-3c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2z'/%3E%3C/svg%3E\");\n\t\t                background-repeat: no-repeat;\n\t\t                background-position: center;\n\t\t                background-color: rgba(0,0,0,0.75);\n\t\t                background-size: 1.5rem;\n\t\t                cursor: not-allowed;\n\t\t        ":"",next.querySelector("*:not(span)").style.zIndex=stop?-1:"",thumbs.querySelectorAll("li").forEach(((e,n)=>{const a=n>t&&stopPages.length,o=e.querySelector("button"),s=o.querySelector("img");o.disabled=a,o.style.cssText=a?"\n\t\t                background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23fff' viewBox='0 0 24 24'%3E%3Cpath d='M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zM9 6c0-1.66 1.34-3 3-3s3 1.34 3 3v2H9V6zm9 14H6V10h12v10zm-6-3c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2z'/%3E%3C/svg%3E\");\n\t\t                background-repeat: no-repeat;\n\t\t                background-position: center;\n\t\t                background-color: rgba(0,0,0,0.75);\n\t\t                background-size: 1.5rem;\n\t\t                pointer-events: none; \n\t\t            ":"",s.style.zIndex=a?-1:"",e.style.cssText=a?"\n\t\t                color: rgba(255,255,255,0.5);\n\t\t                cursor: not-allowed;\n\t\t            ":""}))}else next.disabled=pageIndex===e,stop=!1;nextClickCover.style.cssText=`\n\t\t\t\twidth: ${nextRect.width}px;\n\t\t\t\theight: ${nextRect.height}px;\n\t\t\t\tmargin-left: -${nextRect.width}px;\n\t\t\t\tcursor: not-allowed;\n\t\t\t\tpointer-events: none;\n\t\t\t`,next.insertAdjacentElement("afterend",nextClickCover),nextClickCover.addEventListener("click",(()=>{dispatchEvent(new CustomEvent("stopAndGoMessage"))})),nextClickCover.style.pointerEvents=stop?"":"none"}